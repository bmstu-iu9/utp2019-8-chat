# Описание методов API #
Все запросы выполняются POST запросом по указанному адресу. 
В ответ приходит строка с JSON объектом. 
В случае, если нужно отправить объект, следует записать его в JSON и отправить строкой.  
Выделеные *курсивом* параметры необязательны.

## Используемые объекты ##

Пользователь:

| Имя | Тип | Описание | Пример |
| - | - | - | - |
| id | int | Id пользователя | `1` |
| nickname | string | Никнейм | `"admin"` |
| permissions | int | Битовая маска привелегий пользователя | `7` |
| avatar | string | Название файла аватара | `"photo.png"` |
| channels | array | Список доступных пользователю каналов | `[1, 2, 4, 8]` |
| meta | JSON | Дополнительная информация | `{ "bio": "Software engineer" }` |

## Методы авторизации ##
### Регистрация ###
**/api/register**

Регистрирует нового пользователя

Параметры:

| Имя | Тип | Описание | Пример |
| - | - | - | - |
| login | string | Логин | `"admin"` |
| password | string | Пароль | `"azerty123"` |

Ответ:

| Имя | Тип | Описание | Пример |
| - | - | - | - |
| success | bool | Результат | `true`/`false` |
| *err_cause* | *string* | *Причина ошибки* | `"User with the same nickname already exist"` |

***
### Авторизация ###
**/api/auth**

Авторизация

Параметры:

| Имя | Тип | Описание | Пример |
| - | - | - | - |
| login | string | Логин | `"admin"` |
| password | string | Пароль | `"azerty123"` |

Ответ:

| Имя | Тип | Описание | Пример |
| - | - | - | - |
| success | bool | Результат | `true`/`false` |
| *token* | *string* | *Ключ сессии* | `"aS31L42n21hD"` |
| *err_cause* | *string* | *Причина ошибки* | `"Password is incorrect"` |

## Методы работы с пользователями ##
### Получить информацию о пользователе ###
**/api/get_user**

Авторизация

Параметры:

| Имя | Тип | Описание | Пример |
| - | - | - | - |
| id | int | ID пользователя | `1` |

Ответ:

| Имя | Тип | Описание | Пример |
| - | - | - | - |
| success | bool | Результат | `true`/`false` |
| *user* | *JSON* | *Объект данных о пользователе (см. в начале)* | `{"id":1,"nickname":"admin",...}` |
| *err_cause* | *string* | *Причина ошибки* | `"User with id 1 does not exist"` |

***
### Добавить пользователя к каналу ###
**/api/add_to_channel**

Добавить канал к списку каналов, к которым может подключаться пользователь

Параметры:

| Имя | Тип | Описание | Пример |
| - | - | - | - |
| token | string | Ключ сессии | `"aS31L42n21hD"` |
| user_id | int | ID пользователя | `1` |
| channel_id | int | ID канала | `2` |

Ответ:

| Имя | Тип | Описание | Пример |
| - | - | - | - |
| success | bool | Результат | `true`/`false` |
| *err_cause* | *string* | *Причина ошибки* | `"Channel with id 1 does not exist"` |

***
### Удалить пользователя из канала ###
**/api/remove_from_channel**

Удвлить канал из списка каналов, к которым может подключаться пользователь.
Если пользователь не имеет доступа к этому каналу метод все-равно вернет успех.

Параметры:

| Имя | Тип | Описание | Пример |
| - | - | - | - |
| token | string | Ключ сессии | `"aS31L42n21hD"` |
| user_id | int | ID пользователя | `1` |
| channel_id | int | ID канала | `2` |

Ответ:

| Имя | Тип | Описание | Пример |
| - | - | - | - |
| success | bool | Результат | `true`/`false` |
| *err_cause* | *string* | *Причина ошибки* | `"Channel with id 1 does not exist"` |

***
### Изменить аватар пользователю ###
**/api/change_avatar**

Изменить аватар у пользователя. Чтобы удалить аватар следует указать пустую строку.
Если такого файла не существует, то метод все равно вернет успех.
Загрузка аватара производится независимо от этого метода.

Параметры:

| Имя | Тип | Описание | Пример |
| - | - | - | - |
| token | string | Ключ сессии | `"aS31L42n21hD"` |
| user_id | int | ID пользователя | `1` |
| avatar | string | Имя нового файла | `"photo.png"` |

Ответ:

| Имя | Тип | Описание | Пример |
| - | - | - | - |
| success | bool | Результат | `true`/`false` |
| *err_cause* | *string* | *Причина ошибки* | `"User with id 1 does not exist"` |

***
### Изменить метаданные пользователя ###
**/api/change_avatar**

Изменить аватар у пользователя. Чтобы удалить аватар следует указать пустую строку.
Если такого файла не существует, то метод все равно вернет успех.
Загрузка аватара производится независимо от этого метода.

Параметры:

| Имя | Тип | Описание | Пример |
| - | - | - | - |
| token | string | Ключ сессии | `"aS31L42n21hD"` |
| user_id | int | ID пользователя | `1` |
| meta | string | Новые метаданные | `{ "bio": "BMSTU student" }` |

Ответ:

| Имя | Тип | Описание | Пример |
| - | - | - | - |
| success | bool | Результат | `true`/`false` |
| *err_cause* | *string* | *Причина ошибки* | `"User with id 1 does not exist"` |
