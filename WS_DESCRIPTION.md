# Описание сообщений WebSockets #

Каждое сообщение представляет собой строку, описывающую JSON объект.

## Сообщения клиента ##

Каждое сообщение клиента должно содержать поле `type`, описывающее тип передаваемого сообщения. Допустимые типы перечислены ниже. Пример сообщения клиента:
```JSON
    {
        "type": "send_message",
        "token": "aLpHaBeTaGaMmaDElTa7",
        "channel_id": 1,
        "messge": "Hello world"
    }
```

### Выбрать канал ###
**set_channel**

В случае успеха подписывает клиент на получение сообщений из выбранного канала. 

Обязательные параметры:

| Название   | Тип    | Описание               | Пример                   |
| ---------- | ------ | ---------------------- | ------------------------ |
| token      | string | Ключ сессии            | `"aLpHaBeTaGaMmaDElTa7"` |
| channel_id | int    | Канал для переключения | `1`                      |

***
### Отправить сообщение ###

Отправляет сообщение в выбранный канал. 

Обязательные параметры:

| Название   | Тип    | Описание               | Пример                   |
| ---------- | ------ | ---------------------- | ------------------------ |
| token      | string | Ключ сессии            | `"aLpHaBeTaGaMmaDElTa7"` |
| channel_id | int    | Канал для переключения | `1`                      |
| message    | string | Текст сообщения        | `Hello world`            |

## Сообщения сервера ##

Каждое сообщение сервера должно содержать поле `success`, обозначающее успешность операции. Если операция успешна, сообщение должно содержать поле `type` (например, `"new_message"`), описывающее тип сообщения. Возможные значения типа приведены ниже. Если операция не успешна, собщение также должно содержать поля `err_code` и `err_cause`, сообщающие код ошибки и ее текстовое описание.

### Новое сообщение ###
**new_message**

Обязательные параметры:

| Название | Тип  | Описание                                 | Пример   |
| -------- | ---- | ---------------------------------------- | -------- |
| data     | JSON | Объект сообщения (см. [API_DESCRIPTION]) | См. ниже |

[API_DESCRIPTION]:https://github.com/bmstu-iu9/utp2019-8-chat/blob/dev/API_DESCRIPTION.md

Пример сообщения:

```JSON
    {
        "message_id":3,
        "author_id":1,
        "author_name":"admin",
        "message":"alive",
        "time":1566589812977,
        "channel_id":1
    }
```

